%Parametry dla czasu symulacji 100s
%sredniastopabledu = [0.036890918, 0.043872906, 0.062467357, 0.080536671, 0.104474812, 0.135158802, 0.178587852, 0.2288];
%max_st_bl=[0.065836299, 0.067082683, 0.097264438, 0.120556414, 0.14351145, 0.185074627, 0.232142857, 0.293670886];
%przeplywnosc=[57.041940732, 58.576072609, 59.273412368, 59.978179714, 60.189961739, 59.889510942, 58.539679073, 56.403959926];
%lambda=[0.0059, 0.0061, 0.0063, 0.0065, 0.0067, 0.0069, 0.0071, 0.0073];



%Parametry dla czasu symulacji 500s
oczekiwane=[0.10, 0.10, 0.10, 0.10, 0.10, 0.10, 0.10, 0.10];
lambda=[0.0059, 0.0061, 0.0063, 0.0065, 0.0067, 0.0069, 0.0071, 0.0073];
sredniastopabledu = [0.0357552720334753, 0.0459013810027895, 0.0608012128267061, 0.0800378621766089, 0.102313688643229, 0.134118677429831, 0.17335970486042, 0.22313773947768];
max_st_bl=[0.046211349, 0.059484468, 0.078587337, 0.10359668, 0.124924925, 0.172711572, 0.198962882, 0.257907543];
przeplywnosc=[56.902944037, 58.177655135, 59.156267604, 59.777116945, 60.159152428, 59.759826143, 58.703764955, 56.710446621];

%lambda 0.0059
srednia0 = 0.0357552720334753;
%obserwacja0 = [0.0393155329066793, 0.048270363745468, 0.0322673270536514, 0.0275406407372433, 0.0320524586365979,  0.0482866403032199, 0.0405301492995039,  0.0282261210782292,  0.0358877195817142,  0.0365322270507283];
obserwacja0=[0.0354500483563142, 0.0425632152132607, 0.0344436352709205, 0.0343497795744759, 0.0366740524246932, 0.0375693320809715, 0.0330394609108281, 0.0303519846120793, 0.0383169220782204, 0.0347942898129896];
s0=std(obserwacja0);
gorna0=gorna_gr(s0, srednia0);
dolna0=dolna_gr(s0, srednia0);

%lambda 0.0061
srednia1 = 0.0459013810027895;
%obserwacja1 =[0.0522397256996372, 0.0433096077163147, 0.0383203536329658, 0.0373020331627184, 0.0475344448301631,  0.0447456240207503, 0.0468575134469056,  0.0302170041833928,  0.0463002363148451,  0.0519025199619832];
obserwacja1=[0.0454294713832863, 0.056249877500684, 0.0415346251469873, 0.0451218921911145, 0.0411002853010381, 0.0480904220507708, 0.0432064573222806, 0.0431742729248545, 0.0450575826764028, 0.0500489235304761];
s1=std(obserwacja1);
gorna1=gorna_gr(s1, srednia1);
dolna1=dolna_gr(s1, srednia1);

%lambda 0.0063
srednia2 = 0.0608012128267061;
%obserwacja2 = [0.0731604203258912, 0.0871579755268719, 0.0572126489213861, 0.0594645010248957, 0.0577558405313277, 0.0516177243471708, 0.0646135139619488,  0.0483985927063122,  0.0628199619122874,  0.0624723931927674];
obserwacja2=[0.0614861080018693, 0.0734301385055755, 0.0535138489207082, 0.0588872862423221, 0.0576527801926275, 0.0605363276267824, 0.0576381324192021, 0.056335013442063, 0.0643252122906673, 0.0642072806252435];
s2=std(obserwacja2);
gorna2=gorna_gr(s2, srednia2);
dolna2=dolna_gr(s2, srednia2);

%lambda 0.0065
srednia3 = 0.0800378621766089;
%obserwacja3 = [0.0945496183452994, 0.0795580288349413, 0.0675417807142839, 0.0749910513343806,  0.0794937852591207, 0.083125217995387, 0.0816916115011673, 0.0465813327369817, 0.0932954739002066,  0.104538814128637];
obserwacja3=[0.0840129934466694, 0.0961903381253049, 0.0738094341517201, 0.0738333355504186, 0.0747722072629551, 0.0727050215882609, 0.0771235576842419, 0.0737491205414362, 0.0898430621847838, 0.0843395512302979];
s3=std(obserwacja3);
gorna3=gorna_gr(s3, srednia3);
dolna3=dolna_gr(s3, srednia3);

%lambda 0.0067 - poprawione
srednia4 = 0.102313688643229;
%obserwacja4 = [0.128840007173471, 0.109554202569006, 0.0788153613947024, 0.0941620231672602, 0.117546565321074, 0.134658934649713, 0.0897338023909176, 0.0690235120717977, 0.109112468026453, 0.113301246768191];
obserwacja4=[0.108346245885078, 0.115561166693093, 0.0905118281774789, 0.0998812573459904, 0.0980757350305159, 0.110754633133751, 0.0942125250324477, 0.0877332271674594, 0.105052363706519, 0.113007904259953];
s4=std(obserwacja4);
gorna4=gorna_gr(s4, srednia4);
dolna4=dolna_gr(s4, srednia4);

%lambda 0.0069
srednia5=0.134118677429831;
%obserwacja5=[0.147554945837308, 0.158987511377539, 0.104714609447693, 0.122910559481556, 0.141718411385376, 0.153150265740161, 0.1353128171924, 0.0967330029120188, 0.165668484395026, 0.124837414367284];
obserwacja5=[0.137303339128452, 0.160347245765849, 0.122072070241664, 0.132479635360172, 0.122320817192782, 0.133939993411437, 0.135825013943609, 0.123046142925955, 0.142901787188266, 0.130950729140124];
s5=std(obserwacja5);
gorna5=gorna_gr(s5, srednia5);
dolna5=dolna_gr(s5, srednia5);

%lambda 0.0071
srednia6= 0.17335970486042;
%obserwacja6=[0.189702790684116, 0.200458565169354, 0.146232539629213, 0.172183722567824, 0.188312747347396, 0.188427343521443, 0.162597100358407, 0.147197980920051, 0.196674662809078, 0.194091066078742];
obserwacja6=[0.18195660994454, 0.192185468369784, 0.160857751200094, 0.164778304736623, 0.157686263936359, 0.174093773384771, 0.166803175523672, 0.180144599244403, 0.171289863361575, 0.183801238902376];
s6=std(obserwacja6);
gorna6=gorna_gr(s6, srednia6);
dolna6=dolna_gr(s6, srednia6);

%lambda 0.0073
srednia7=0.22313773947768;
%obserwacja7=[ 0.252897462135378, 0.232223399987824, 0.187612330259017, 0.188553317523558, 0.250806044488625, 0.266172698978796, 0.214966908256393, 0.191055201416634, 0.271688730350366, 0.23153608038502];
obserwacja7=[0.226381619020976, 0.243264257913606, 0.193560385346736, 0.210574287527405, 0.21075294482138, 0.240042493926764, 0.211874904789477, 0.226459225801473, 0.227964798243007, 0.240502477385971];
s7=std(obserwacja7);
gorna7=gorna_gr(s7, srednia7);
dolna7=dolna_gr(s7, srednia7);

granica_gorna=[gorna0, gorna1, gorna2, gorna3, gorna4, gorna5, gorna6, gorna7];
granica_dolna=[dolna0, dolna1, dolna2, dolna3, dolna4, dolna5, dolna6, dolna7];
%Rysunek: Wyznaczanie parametru lambda
figure(1);
plot(lambda, sredniastopabledu, "b-o", "markersize", 10, "markerfacecolor", "auto"); axis([0.0058 0.0074 0 0.26]); hold on;
plot(lambda, oczekiwane, 'c'); axis([0.0058 0.0074 0 0.26]); hold on;
plot(lambda, granica_gorna,'r*'); axis([0.0058 0.0074 0 0.26]); hold on;
plot(lambda, granica_dolna,'*'); axis([0.0058 0.0074 0 0.26]);
h=legend("sredni czas oczekiwania", "poszukiwana srednia oczekiwana", "gorna granica przedzialu ufnosci", "dolna granica przedzialu ufnosci", 'location', "northwest");
legend boxoff
title("Wyznaczanie parametru lambda");
xlabel("Wartosci lambda");
ylabel("Srednia pakietowa stopa bledow");
grid on

%Rysunek: Maksymalna stopa bledu
figure(2);
plot(lambda, max_st_bl, "b-o", "markersize", 10, "markerfacecolor", "auto"); hold on;
title("Maksymalna pakietowa stopa bledow");
xlabel("Wartosci lambda");
ylabel("Maksymalna pakietowa stopa bledow");
grid on
%Rysunek: przeplywnosc systemu
figure(3);
plot(lambda, przeplywnosc, "b-o", "markersize", 10, "markerfacecolor", "auto"); hold on;
title("Przeplywnosc systemu");
xlabel("Wartosci lambda");
ylabel("Przeplywnosc systemu [pakiet/sekunde]");
grid on